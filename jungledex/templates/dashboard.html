<!doctype html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <title>정글덱스 | 대쉬보드</title>
</head>

<body>

    <div class="mx-auto max-w-6xl bg-white rounded-xl p-8">
        <!-- 상단 -->
        <div class="pb-6 border-b border-gray-300 relative">
            <!-- 카테고리 멘트 -->
            <div>
                <h1 class="text-2xl font-bold text-gray-800">ㅁㄴㅇㄹ</h1>
                <p class="text-gray-600 mt-1">asdf</p>
            </div>
            <!-- 랜덤 버튼 -->
            <button
                class="absolute right-20 bottom-0 mb-2 mr-2 bg-indigo-600 text-white px-4 py-2 rounded-full shadow hover:bg-indigo-500 transition">
                랜덤
            </button>
            <!-- 로그아웃 버튼 -->
            <button id="logoutBtn"
                class="absolute right-0 bottom-0 mb-2 mr-2 bg-red-600 text-white px-4 py-2 rounded-full shadow hover:bg-red-500 transition">
                로그아웃
            </button>
        </div>

        <!-- 하단 -->
        <div class="pt-6 flex justify-around items-center border-b border-gray-300 relative pb-5">
            {% for user in users %}
            <div class="flex flex-col items-center">
                <img src="{{ user.get('profile_url') | default('/jungledex/static/default-profile.jpg', true) }}"
                    alt="프로필 이미지"
                    class="sm:w-32 sm:h-32 md:w-48 md:h-48 lg:w-64 lg:h-64 rounded-full border-4 border-gray-300 mb-2">
                <span class="mt-1 font-semibold">{{ user.get('username') }}</span>
            </div>
            {% endfor %}
        </div>

    </div>

    <script>
        document.getElementById('logoutBtn').addEventListener('click', async () => {
            try {
                const res = await fetch('/api/auth/logout', {
                    method: 'POST',
                    credentials: 'include'  // 쿠키 전송
                });
                if (res.ok) {
                    // 로그아웃 성공 시 홈으로 이동
                    window.location.href = '/';
                } else {
                    console.error('로그아웃 실패:', res.status, await res.text());
                }
            } catch (err) {
                console.error('네트워크 에러:', err);
            }
        });
    </script>

</body>

</html>
